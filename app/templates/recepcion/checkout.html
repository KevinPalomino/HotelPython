{% extends "base.html" %}

{% block title %}Check-out - Hotel Management{% endblock %}

{% block content %}
<div class="breadcrumb">
    <a href="{{ url_for('recepcion.panel_recepcionista') }}">
        <i class="fas fa-concierge-bell"></i> Panel Recepci贸n
    </a>
    <span> / Check-out</span>
</div>

<h1 class="page-title">
    <i class="fas fa-sign-out-alt"></i>
    Check-Out
</h1>

<!-- Formulario de filtro por fecha -->
<div class="card mb-4">
    <div class="card-body">
        <form method="GET" action="{{ url_for('recepcion.ver_reservas_checkout') }}" class="form-inline">
            <div class="form-group mr-2 mb-0">
                <label for="fecha" class="mr-2">Filtrar por fecha:</label>
                <input type="date" id="fecha" name="fecha" class="form-control" value="{{ fecha_filtro }}" min="{{ hoy }}">
            </div>
            <button type="submit" class="btn btn-primary"><i class="fas fa-filter"></i> Filtrar</button>
            <a href="{{ url_for('recepcion.ver_reservas_checkout') }}" class="btn btn-secondary ml-2"><i class="fas fa-broom"></i> Limpiar</a>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Check-outs Programados para el {{ fecha_filtro }}</h2>
    </div>

    {% if reservas %}
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th><i class="fas fa-user"></i> Cliente</th>
                    <th><i class="fas fa-bed"></i> Habitaci贸n</th>
                    <th><i class="fas fa-home"></i> Tipo</th>
                    <th><i class="fas fa-calendar-alt"></i> Fecha Ingreso</th>
                    <th><i class="fas fa-calendar-alt"></i> Fecha Salida</th>
                    <th><i class="fas fa-info-circle"></i> Estado</th>
                    <th><i class="fas fa-cogs"></i> Acci贸n</th>
                </tr>
            </thead>
            <tbody>
                {% for r, h, p in reservas %}
                <tr>
                    <td>{{ p.nombre }}</td>
                    <td>Habitaci贸n {{ h.idhabitaciones }}</td>
                    <td>{{ h.tipo }}</td>
                    <td>{{ r.checkin.strftime('%Y-%m-%d') }}</td>
                    <td>{{ r.checkout.strftime('%Y-%m-%d') }}</td>
                    <td>
                        <span class="status-badge status-active">En Curso</span>
                    </td>
                    <td class="actions">
                        <a href="{{ url_for('recepcion.hacer_checkout', reserva_id=r.idreservas) }}" class="btn btn-warning">
                            <i class="fas fa-sign-out-alt"></i>
                            Hacer Check-out
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="text-center p-3">
        <i class="fas fa-info-circle" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
        <p style="color: var(--text-light); font-size: 1.1rem;">No hay check-outs programados para la fecha seleccionada.</p>
    </div>
    {% endif %}
</div>

<style>
.status-active {
    background-color: #28a745;
    color: white;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: bold;
}
</style>

{% endblock %}